<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Verification</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }

        #result {
            font-size: 30px;
            font-weight: bold;
            margin-top: 20px;
        }

        .timestamp {
            font-size: 16px;
            color: gray;
            margin-top: 10px;
        }

        #logo {
            width: 150px;
            margin-bottom: 20px;
            display: none; /* Initially hidden */
        }

        .product-description {
            text-align: center;
            margin-top: 20px;
            font-size: 16px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            display: none; /* Initially hidden */
        }

        .disclaimer {
            font-size: 14px;
            color: gray;
            margin-top: 30px;
            display: none; /* Initially hidden */
        }

        /* Show unverified message */
        .unverified {
            display: block;
            font-size: 30px;
            font-weight: bold;
            color: red;
            margin-top: 50px;
        }
    </style>
</head>

<body>
    <!-- Add Logo (Change to .jpg) -->
    <img id="logo" src="https://raw.githubusercontent.com/verifiedproductlk/verifiedproductlk/main/logoS2F.jpg" alt="Logo">

    <h2>Product Verification</h2>

    <!-- Message for unverified product -->
    <div id="result">Unverified Product</div>

    <div id="timestamp" class="timestamp"></div>

    <!-- Product Description -->
    <div class="product-description">
        <h2>Product Benefits</h2>
        <p>This formula is designed to increase appetite and enhance energy levels throughout the day while promoting a healthy, well-shaped body without excessive fat. It helps stabilize metabolism and supports weight gain by maximizing the body's utilization of essential nutrients. Additionally, it aids in smoothing the digestive system, ensuring efficient nutrient absorption for overall well-being.</p>
    </div>

    <!-- Disclaimer -->
    <div class="disclaimer">
        <p>Disclaimer: This product verification is for informational purposes only. Please refer to the official website for full terms and conditions.</p>
    </div>

    <script>
        // Ensure everything runs after the page is fully loaded
        document.addEventListener("DOMContentLoaded", function () {

            async function verifyProduct() {
                const urlParams = new URLSearchParams(window.location.search);
                const code = urlParams.get("code");

                // If no code is provided in the URL, show "Invalid QR Code" message
                if (!code) {
                    document.getElementById("result").innerHTML = "‚ùå Invalid QR Code";
                    document.getElementById("timestamp").innerHTML = getTimestamp();
                    document.getElementById("result").style.display = "block"; // Show message
                    return;
                }

                try {
                    // Call Cloudflare Worker API for verification
                    const response = await fetch(`https://crimson-dawn-5f3d.businesstroffice.workers.dev/?code=${code}`);

                    // Check if the response is successful
                    if (!response.ok) {
                        throw new Error("Failed to verify product");
                    }

                    // Parse JSON response
                    const data = await response.json();

                    // If the result is "Unverified Product", show the message
                    if (data.result === "Unverified Product") {
                        document.getElementById("result").innerHTML = "Unverified Product";
                        document.getElementById("result").style.display = "block"; // Show the unverified message
                        document.getElementById("timestamp").innerHTML = `üïí Scanned on: ${getTimestamp()}`;
                        document.getElementById("timestamp").style.display = "block"; // Show timestamp
                        hideVerifiedContent(); // Hide verified content
                    } else if (data.result === "Verified Product") {
                        document.getElementById("result").innerHTML = "Verified Product"; // Update result
                        document.getElementById("result").style.display = "block"; // Show result message
                        document.getElementById("timestamp").innerHTML = `üïí Scanned on: ${getTimestamp()}`;
                        document.getElementById("timestamp").style.display = "block"; // Show timestamp
                        showVerifiedContent(); // Show all content for verified product
                    }
                } catch (error) {
                    console.error("Verification error:", error);
                    document.getElementById("result").innerHTML = "‚ö†Ô∏è ‚ùå Unverified Product";
                    document.getElementById("timestamp").innerHTML = getTimestamp();
                    document.getElementById("result").style.display = "block"; // Show message
                    hideVerifiedContent(); // Hide verified content in case of error
                }
            }

            function getTimestamp() {
                const now = new Date();
                return now.toLocaleString(); // Formats as "MM/DD/YYYY, HH:MM:SS AM/PM"
            }

            // Function to show all content for verified product
            function showVerifiedContent() {
                document.getElementById("logo").style.display = "block"; // Show the logo
                document.querySelector(".product-description").style.display = "block"; // Show product description
                document.querySelector(".disclaimer").style.display = "block"; // Show disclaimer
            }

            // Function to hide all content for unverified product
            function hideVerifiedContent() {
                document.getElementById("logo").style.display = "none"; // Hide the logo
                document.querySelector(".product-description").style.display = "none"; // Hide product description
                document.querySelector(".disclaimer").style.display = "none"; // Hide disclaimer
            }

            // Run the verification function on page load
            verifyProduct();

        });
    </script>
</body>

</html>
